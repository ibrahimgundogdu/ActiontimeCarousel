@model EmployeeControlModel
@{
    ViewBag.Title = "Çalışan İşlemleri";
}

@section style{
    <link rel="stylesheet" href="/assets/css/dashforge.profile.css">
}

<div class="content-header">
    <div class="content-search">
        <h4>Yeni Çalışan Ekleme</h4>

    </div>
    <nav class="nav">
        @(DateTime.UtcNow.AddHours(Model.Authentication.ActionEmployee.OurCompany.TimeZone.Value).ToLongDateString())
    </nav>
</div>
<div class="content-body">
    <div class="pd-x-0 tx-13">
        <div class="media d-block d-lg-flex">
            <div class="media-body  mg-t-40 mg-lg-t-0">
                <div class="d-sm-flex align-items-center justify-content-between mg-b-20 mg-lg-b-25 mg-xl-b-30 row">
                    <div class=" col-md-4">
                        <a href="/Employee/AddEmployee" class="btn btn-warning btn-uppercase"><i data-feather="chevron-left"></i> &nbsp; 01. Temel Bilgiler </a>
                    </div>
                    <div class="col-md-4 tx-center">
                        <h4 class="mg-b-0 tx-spacing--1">03. Tüm Bilgiler</h4>
                    </div>
                    <div class="d-none d-md-block col-md-4 tx-right">
                        <a href="/Employee/" class="btn btn-primary btn-uppercase"><i data-feather="users"></i> &nbsp; Çalışanlar Listesi</a>
                    </div>
                </div>
                <div id="employeeStatus">
                    <div class="row no-gutters">
                        <div class="col-lg-12">
                            @using (Html.BeginForm("AddEmployeeCompleteForm", "Employee", FormMethod.Post, new { enctype = "multipart/form-data" }))
                            {
                                @Html.AntiForgeryToken()


                                <div class="form-group row">
                                    <label for="Title" class="col-sm-3 col-form-label">Tanımı</label>
                                    <div class="col-sm-6">
                                        <input id="Title" name="Title" type="text" class="form-control" autocomplete="off" placeholder="Title">
                                    </div>
                                    <div class="col-sm-3">
                                    </div>
                                </div>

                                <div class="form-group row mg-b-5 bg-gray-50">
                                    <label for="IdentityType" class="col-sm-3 col-form-label">Kimlik Tipi</label>
                                    <div class="col-sm-6">
                                        <select class="form-control" id="IdentityType" name="IdentityType" readonly>
                                            @foreach (var item in Model.IdentityTypes)
                                            {
                                                <option value="@item.TypeCode" @(Model.CheckEmployee.IdentityType == item.TypeCode ? "selected" : "disabled")>@($"{item.TypeName}")</option>
                                            }
                                        </select>
                                    </div>
                                    <div class="col-sm-3">
                                    </div>
                                </div>

                                <div class="form-group row mg-b-5 bg-gray-50">
                                    <label for="IdentityNumber" class="col-sm-3 col-form-label">Kimlik Numarası</label>
                                    <div class="col-sm-6">
                                        <input id="IdentityNumber" name="IdentityNumber" type="text" class="form-control" value="@(Model.CheckEmployee.IdentityNumber)" @(!string.IsNullOrEmpty(Model.CheckEmployee.IdentityNumber) && Model.CheckEmployee.IdentityNumber.Length >= 10 ? "readonly" : "") autocomplete="off" placeholder="Kimlik No">
                                    </div>
                                    <div class="col-sm-3">
                                    </div>
                                </div>
                                <div class="form-group row mg-b-5 bg-gray-50">
                                    <label for="FullName" class="col-sm-3 col-form-label">Adı Soyadı</label>
                                    <div class="col-sm-6">
                                        <input id="FullName" name="FullName" type="text" class="form-control" autocomplete="off" value="@(Model.CheckEmployee.FullName)" @(!string.IsNullOrEmpty(Model.CheckEmployee.FullName) && Model.CheckEmployee.FullName.Length >= 3 ? "readonly" : "") placeholder="Ad Soyad" required>
                                    </div>
                                    <div class="col-sm-3">
                                    </div>
                                </div>
                                <div class="form-group row mg-b-5 bg-gray-50">
                                    <label for="E_mail" class="col-sm-3 col-form-label">Emaili</label>
                                    <div class="col-sm-6">
                                        <input id="E_mail" name="EMail" type="email" class="form-control" autocomplete="off" value="@(Model.CheckEmployee.EMail)" @(!string.IsNullOrEmpty(Model.CheckEmployee.EMail) && Model.CheckEmployee.EMail.Length >= 7 ? "readonly" : "") placeholder="E-Posta Adresi">
                                    </div>
                                    <div class="col-sm-3">
                                    </div>
                                </div>

                                <div class="form-group row bg-gray-50">
                                    <label for="Mobile" class="col-sm-3 col-form-label">Telefonu</label>
                                    <div class="col-sm-3">
                                        <select class="form-control" id="CountryPhoneCode" name="CountryPhoneCode">
                                            @foreach (var item in Model.PhoneCodes)
                                            {
                                                <option value="@item.Code" @(Model.CheckEmployee.CountryPhoneCode == item.Code ? "selected" : "")>@($"{item.Code} {item.Country}")</option>
                                            }
                                        </select>
                                    </div>
                                    <div class="col-sm-3">
                                        <input id="Mobile" name="Mobile" type="text" class="form-control phone" autocomplete="off" value="@(Model.CheckEmployee.Mobile)" @(!string.IsNullOrEmpty(Model.CheckEmployee.Mobile) && Model.CheckEmployee.Mobile.Length >= 7 ? "readonly" : "") placeholder="Telefon">
                                    </div>
                                    <div class="col-sm-3">
                                    </div>
                                </div>


                                <div class="form-group row mg-b-5">
                                    <label for="Username" class="col-sm-3 col-form-label">Kullanıcı Adı</label>
                                    <div class="col-sm-6">
                                        <input id="Username" name="Username" type="text" class="form-control" autocomplete="off" placeholder="Kullanıcı Adı">
                                    </div>
                                    <div class="col-sm-3">
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label for="Password" class="col-sm-3 col-form-label">Şifresi</label>
                                    <div class="col-sm-6">
                                        <input id="Password" name="Password" type="text" class="form-control" autocomplete="off" placeholder="Şifre">
                                    </div>
                                    <div class="col-sm-3">
                                    </div>
                                </div>

                                <div class="form-group row bg-gray-50 mg-b-5">
                                    <label for="RoleGroupID" class="col-sm-3 col-form-label">Yetki Rol Grubu</label>
                                    <div class="col-sm-6">
                                        <select class="form-control" id="RoleGroupID" name="RoleGroupID" required>
                                            <option value="">Yetki Rol Grubu Seçiniz </option>
                                            @foreach (var item in Model.RoleGroupList.OrderBy(x => x.RoleLevel))
                                            {
                                                <option value="@item.ID" @(item.RoleLevel1.LevelNumber > Model.Authentication.ActionEmployee.RoleGroup.RoleLevel ? "disabled" : "")>@($"{item.GroupCode} {item.GroupName}")</option>
                                            }
                                        </select>
                                    </div>
                                    <div class="col-sm-3">
                                    </div>
                                </div>

                                <div class="form-group row mg-b-5 bg-gray-50">
                                    <label for="AreaCategoryID" class="col-sm-3 col-form-label">Alanı</label>
                                    <div class="col-sm-6">
                                        <select class="form-control" id="AreaCategoryID" name="AreaCategoryID" required>
                                            <option value="">Alan Seçiniz </option>
                                            @foreach (var item in Model.AreaCategoryList.OrderBy(x => x.SortBy))
                                            {
                                                <option value="@item.ID">@($"{item.SortBy} {item.AreaName}")</option>
                                            }
                                        </select>
                                    </div>
                                    <div class="col-sm-3">
                                    </div>
                                </div>
                                <div class="form-group row mg-b-5 bg-gray-50">
                                    <label for="DepartmentID" class="col-sm-3 col-form-label">Departmanı</label>
                                    <div class="col-sm-6">
                                        <select class="form-control" id="DepartmentID" name="DepartmentID" required>
                                            <option value="">Departman Seçiniz </option>
                                            @foreach (var item in Model.DepartmentList.OrderBy(x => x.SortBy))
                                            {
                                                <option value="@item.ID">@($"{item.SortBy} {item.DepartmentName}")</option>
                                            }
                                        </select>
                                    </div>
                                    <div class="col-sm-3">
                                    </div>
                                </div>
                                <div class="form-group row mg-b-5 bg-gray-50">
                                    <label for="PositionID" class="col-sm-3 col-form-label">Pozisyonu</label>
                                    <div class="col-sm-6">
                                        <select class="form-control" id="PositionID" name="PositionID" required>
                                            <option value="">Pozisyon Seçiniz </option>
                                            @foreach (var item in Model.PositionList.OrderBy(x => x.SortBy))
                                            {
                                                <option value="@item.ID">@($"{item.SortBy} {item.PositionName}")</option>
                                            }
                                        </select>
                                    </div>
                                    <div class="col-sm-3">
                                    </div>
                                </div>
                                <div class="form-group row mg-b-5 bg-gray-50">
                                    <label for="StatusID" class="col-sm-3 col-form-label">Durumu</label>
                                    <div class="col-sm-6">
                                        <select class="form-control" id="StatusID" name="StatusID" required>
                                            <option value="">Durum Seçiniz </option>
                                            @foreach (var item in Model.StatusList)
                                            {
                                                <option value="@item.ID">@($"{item.Code} {item.Name}")</option>
                                            }
                                        </select>
                                    </div>
                                    <div class="col-sm-3"></div>
                                </div>
                                <div class="form-group row mg-b-5 bg-gray-50">
                                    <label for="ShiftTypeID" class="col-sm-3 col-form-label">Çalışma Türü</label>
                                    <div class="col-sm-6">
                                        <select class="form-control" id="ShiftTypeID" name="ShiftTypeID" required>
                                            <option value="">Çalışma Türünü Seçiniz </option>
                                            @foreach (var item in Model.ShiftTypeList)
                                            {
                                                <option value="@item.ID">@($"{item.SortBy} {item.TypeName}")</option>
                                            }
                                        </select>
                                    </div>
                                    <div class="col-sm-3"></div>
                                </div>
                                <div class="form-group row mg-b-5 bg-gray-50">
                                    <label for="SalaryCategoryID" class="col-sm-3 col-form-label">Ücret Kategorisi</label>
                                    <div class="col-sm-6">
                                        <select class="form-control" id="SalaryCategoryID" name="SalaryCategoryID" required>
                                            <option value="">Ücret Kategorisi Seçiniz </option>
                                            @foreach (var item in Model.SalaryCategoryList)
                                            {
                                                <option value="@item.ID">@($"{item.SortBy} {item.SalaryCategoryName}")</option>
                                            }
                                        </select>
                                    </div>
                                    <div class="col-sm-3">
                                    </div>
                                </div>
                                <div class="form-group row bg-gray-50">
                                    <label for="SequenceID" class="col-sm-3 col-form-label">Oryantasyon Seviyesi</label>
                                    <div class="col-sm-6">
                                        <select class="form-control" id="SequenceID" name="SequenceID" required>
                                            <option value="">Oryantasyon Seviyesi Seçiniz </option>
                                            @foreach (var item in Model.SequenceList)
                                            {
                                                <option value="@item.ID">@($"{item.Code} {item.Name}")</option>
                                            }
                                        </select>
                                    </div>
                                    <div class="col-sm-3">
                                    </div>
                                </div>

                                <div class="form-group row">
                                    <label for="FotoFile" class="col-sm-3 col-form-label">Fotoğrafı</label>
                                    <div class="col-sm-6">
                                        <input type="file" id="FotoFile" name="FotoFile" style="width: 100%;" class="form-control" />
                                    </div>
                                    <div class="col-sm-3"> </div>
                                </div>

                                <div class="form-group row">
                                    <label for="Description" class="col-sm-3 col-form-label">Açıklama</label>
                                    <div class="col-sm-6">
                                        <textarea id="Description" name="Description" rows="5" class="form-control" style="width:100% !important;"></textarea>
                                    </div>
                                    <div class="col-sm-3"> </div>
                                </div>

                                <div class="form-group row bg-gray-50">
                                    <label for="OurCompanyID" class="col-sm-3 col-form-label">Ana Firma</label>
                                    <div class="col-sm-6">
                                        <select class="form-control" id="OurCompanyID" name="OurCompanyID" required>
                                            @foreach (var item in Model.OurList)
                                            {
                                                <option value="@item.CompanyID" @(Model.Authentication.ActionEmployee.OurCompanyID == item.CompanyID ? "selected" : "")>@($"{item.CompanyName}")</option>
                                            }
                                        </select>
                                    </div>
                                    <div class="col-sm-3">
                                    </div>
                                </div>

                                <div class="form-group row bg-gray-50">
                                    <label for="LocationID" class="col-sm-3 col-form-label">İlişkili Lokasyonu</label>
                                    <div class="col-sm-6">
                                        <select class="form-control" id="LocationID" name="LocationID" required>
                                            <option value="">İlişkili Lokasyonu Seçiniz </option>
                                            @foreach (var item in Model.LocationList)
                                            {
                                                <option value="@item.LocationID">@($"{item.LocationFullName}")</option>
                                            }
                                        </select>
                                    </div>
                                    <div class="col-sm-3">
                                    </div>
                                </div>

                                <div class="form-group row mg-b-0">
                                    <div class="col-sm-3"></div>
                                    <div class="col-sm-6">
                                        <button type="submit" class="btn btn-primary btn-block">Çalışanı Ekle</button>
                                    </div>
                                    <div class="col-sm-3">
                                    </div>
                                </div>
                            }
                        </div>
                    </div>
                </div>



            </div>
        </div>
    </div>
</div>

@section scripts {
    <script>

        $('#IdentityType').on('change', function () {
            $('#IdentityNumber').attr('placeholder', this.value)
        });

        $('.phone').mask('(000) 000 00 00');


        $(document).ready(function () {
            $("#OurCompanyID").change(function () {

                var ourCompanyID = $("#OurCompanyID").val();

                console.log(ourCompanyID);

                $.ajax
                    ({
                        url: '/Employee/GetLocationList',
                        type: 'POST',
                        datatype: 'application/json',
                        contentType: 'application/json',
                        data: JSON.stringify({
                            ourCompanyId: ourCompanyID
                        }),
                        success: function (data) {

                            $("#LocationID").empty();

                            $("#LocationID").append($('<option></option>', { "value": '', "text": 'İlişkili Lokasyon Seçiniz' }));

                            $.each(data, function (index, label) {
                                $("#LocationID").append($('<option></option>', { "value": label.Value, "text": label.Text }));
                            });
                        },
                        error: function () {
                        },
                    });
            });
        });

    </script>

    @if (Model.Result != null) //
    {
        <script type="text/javascript">
        $.toast({
            heading: 'Information',
            text: '@Model.Result.Message ',
            showHideTransition: 'slide',
            icon: 'info',
            hideAfter: 5000,
            position: 'bottom-right',
        });
        </script>
    }
}


