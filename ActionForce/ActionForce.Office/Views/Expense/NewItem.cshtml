@model ExpenseControlModel
@{
    ViewBag.Title = "Masraf Merkezi İşlemleri";

}

@section style{
    <link rel="stylesheet" href="/assets/css/dashforge.profile.css">
}

<div class="content-header">
    <div class="content-search">
        <span class="tx-20">Masraf Kalemleri</span>
    </div>
    <nav class="nav">
        <a href="/Expense"> <i data-feather="menu"></i> </a> &nbsp;
        @(DateTime.UtcNow.AddHours(Model.Authentication.ActionEmployee.OurCompany.TimeZone.Value).ToLongDateString())
    </nav>
</div>
<div class="content-body">
    <div class="pd-x-0 tx-13">
        <div class="media d-block d-lg-flex">
            <div class="media-body  mg-t-40 mg-lg-t-0">
                <div class="d-sm-flex align-items-center justify-content-between mg-b-20 mg-lg-b-25 mg-xl-b-30">
                    <div>
                        <nav aria-label="breadcrumb">
                            <ol class="breadcrumb breadcrumb-style1 mg-b-10">
                                <li class="breadcrumb-item"><a href="/">Anasayfa</a></li>
                                <li class="breadcrumb-item active" aria-current="page"> <a href="/Expense">Masraf Listesi</a></li>
                            </ol>
                        </nav>
                        <h4 class="mg-b-0 tx-spacing--1">Yeni Masraf Kalemi</h4>
                    </div>
                </div>

                @if (Model.ExpenseItem != null)
                {
                    using (Html.BeginForm("EditExpenseItem", "Expense", FormMethod.Post))
                    {
                        @Html.AntiForgeryToken()

                        <div class="row row-xs">
                            <div class="col-lg-12">
                                <div class="form-group row">
                                    <label for="OurCompanyID" class="col-sm-3 col-form-label tx-sm-13">Kurumumuz</label>
                                    <div class="col-sm-6">
                                        <select class="form-control font-weight-bold select2" id="OurCompanyID" name="OurCompanyID" required>
                                            @foreach (var item in Model.OurCompanies.OrderByDescending(x => x.CompanyID))
                                            {
                                                <option value="@(item.CompanyID)" @(Model.ExpenseItem.OurCompanyID == item.CompanyID ? "selected" : "")>@($"{item.Code} - {item.CompanyName}" )</option>
                                            }
                                        </select>
                                    </div>
                                    <div class="col-sm-3">
                                        <input id="UID" name="UID" type="hidden" value="@(Model.ExpenseItem.UID)" />
                                    </div>
                                </div>

                                <div class="form-group row bg-gray-50">
                                    <label for="ExpenseItemName" class="col-sm-3 col-form-label font-weight-bold tx-15">Masraf Kalemi</label>
                                    <div class="col-sm-6">
                                        <input id="ExpenseItemName" name="ExpenseItemName" type="text" class="form-control font-weight-bold tx-15" maxlength="40" autocomplete="off" required value="@(Model.ExpenseItem.ExpenseItemName)" @(Model.ItemEditable == true ? "":"readonly")>
                                    </div>
                                    <div class="col-sm-3">
                                    </div>
                                </div>


                                <div class="form-group row mg-b-0">
                                    <label for="IsLocation" class="col-sm-3 col-form-label">Lokasyon Grubu</label>
                                    <div class="col-sm-6">
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="custom-control-input" id="IsLocation" name="IsLocation" value="1" @(Model.ExpenseItem.IsLocation == true ? "checked" : "")>
                                            <label class="custom-control-label" for="IsActive">Görünür</label>
                                        </div>
                                    </div>
                                    <div class="col-sm-3">
                                    </div>
                                </div>

                                <div class="form-group row mg-b-0">
                                    <label for="IsOffice" class="col-sm-3 col-form-label">İşletme Grubu</label>
                                    <div class="col-sm-6">
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="custom-control-input" id="IsOffice" name="IsOffice" value="1" @(Model.ExpenseItem.IsOffice == true ? "checked" : "")>
                                            <label class="custom-control-label" for="IsActive">Görünür</label>
                                        </div>
                                    </div>
                                    <div class="col-sm-3">
                                    </div>
                                </div>

                                <div class="form-group row">
                                    <label for="IsGeneral" class="col-sm-3 col-form-label">Genel Grubu</label>
                                    <div class="col-sm-6">
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="custom-control-input" id="IsGeneral" name="IsGeneral" value="1" @(Model.ExpenseItem.IsGeneral == true ? "checked" : "")>
                                            <label class="custom-control-label" for="IsActive">Görünür</label>
                                        </div>
                                    </div>
                                    <div class="col-sm-3">
                                    </div>
                                </div>



                                <div class="form-group row">
                                    <label for="SortBy" class="col-sm-3 col-form-label">Sıralaması</label>
                                    <div class="col-sm-6">
                                        <input id="SortBy" name="SortBy" type="text" class="form-control font-weight-bold" maxlength="4" autocomplete="off" value="@(Model.ExpenseItem.SortBy)" required>
                                    </div>
                                    <div class="col-sm-3">
                                    </div>
                                </div>

                                <div class="form-group row">
                                    <label for="IsActive" class="col-sm-3 col-form-label">Aktif</label>
                                    <div class="col-sm-6">
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="custom-control-input" id="IsActive" name="IsActive" value="1" @(Model.ExpenseItem.IsActive == true ? "checked" : "")>
                                            <label class="custom-control-label" for="IsActive">Aktif</label>
                                        </div>
                                    </div>
                                    <div class="col-sm-3">
                                    </div>
                                </div>

                                <div class="form-group row mg-b-0">
                                    <div class="col-sm-3"></div>
                                    <div class="col-sm-6">
                                        <button type="submit" class="btn btn-primary btn-block">Masraf Kalemi Güncelle</button>
                                    </div>
                                    <div class="col-sm-3">
                                    </div>
                                </div>

                            </div>
                        </div>
                    }
                }
                else
                {
                    using (Html.BeginForm("AddExpenseItem", "Expense", FormMethod.Post))
                    {
                        @Html.AntiForgeryToken()

                        <div class="row row-xs">
                            <div class="col-lg-12">
                                <div class="form-group row">
                                    <label for="OurCompanyID" class="col-sm-3 col-form-label tx-sm-13">Kurumumuz</label>
                                    <div class="col-sm-6">
                                        <select class="form-control font-weight-bold select2" id="OurCompanyID" name="OurCompanyID" required>
                                            @foreach (var item in Model.OurCompanies.OrderByDescending(x => x.CompanyID))
                                            {
                                                <option value="@(item.CompanyID)">@($"{item.Code} - {item.CompanyName}" )</option>
                                            }
                                        </select>
                                    </div>
                                    <div class="col-sm-3">
                                    </div>
                                </div>

                                <div class="form-group row bg-gray-50">
                                    <label for="ExpenseItemName" class="col-sm-3 col-form-label font-weight-bold tx-15">Masraf Kalemi</label>
                                    <div class="col-sm-6">
                                        <input id="ExpenseItemName" name="ExpenseItemName" type="text" class="form-control font-weight-bold tx-15" maxlength="40" autocomplete="off" required>
                                    </div>
                                    <div class="col-sm-3">
                                    </div>
                                </div>


                                <div class="form-group row mg-b-0">
                                    <label for="IsLocation" class="col-sm-3 col-form-label">Lokasyon Grubu</label>
                                    <div class="col-sm-6">
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="custom-control-input" id="IsLocation" name="IsLocation" value="1" checked>
                                            <label class="custom-control-label" for="IsActive">Görünür</label>
                                        </div>
                                    </div>
                                    <div class="col-sm-3">
                                    </div>
                                </div>

                                <div class="form-group row mg-b-0">
                                    <label for="IsOffice" class="col-sm-3 col-form-label">İşletme Grubu</label>
                                    <div class="col-sm-6">
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="custom-control-input" id="IsOffice" name="IsOffice" value="1" checked>
                                            <label class="custom-control-label" for="IsActive">Görünür</label>
                                        </div>
                                    </div>
                                    <div class="col-sm-3">
                                    </div>
                                </div>

                                <div class="form-group row">
                                    <label for="IsGeneral" class="col-sm-3 col-form-label">Genel Grubu</label>
                                    <div class="col-sm-6">
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="custom-control-input" id="IsGeneral" name="IsGeneral" value="1" checked>
                                            <label class="custom-control-label" for="IsActive">Görünür</label>
                                        </div>
                                    </div>
                                    <div class="col-sm-3">
                                    </div>
                                </div>

                                <div class="form-group row">
                                    <label for="SortBy" class="col-sm-3 col-form-label">Sıralaması</label>
                                    <div class="col-sm-6">
                                        <input id="SortBy" name="SortBy" type="text" class="form-control font-weight-bold" maxlength="4" autocomplete="off" required>
                                    </div>
                                    <div class="col-sm-3">
                                    </div>
                                </div>

                                <div class="form-group row mg-b-0">
                                    <div class="col-sm-3"></div>
                                    <div class="col-sm-6">
                                        <button type="submit" class="btn btn-success btn-block">Masraf Kalemi Ekle</button>
                                    </div>
                                    <div class="col-sm-3">
                                    </div>
                                </div>

                            </div>
                        </div>
                    }
                }
                <div class="d-sm-flex align-items-center justify-content-between mg-b-20 mg-t-20 mg-lg-b-25 mg-xl-b-30">
                    <div>
                        <h4 class="mg-b-0 tx-spacing--1">Masraf Kalemleri</h4>
                    </div>
                </div>

                <div class="row row-xs">
                    <div class="table-responsive">
                        <table class="table table-bordered table-hover table-striped table-dashboard">

                            <thead>
                                <tr>
                                    <th></th>
                                    <th>#</th>
                                    <th>Kurumumuz</th>
                                    <th>Masraf Kalemi</th>
                                    <th>Lokasyon</th>
                                    <th>İşletme</th>
                                    <th>Genel</th>
                                    <th>Sıra</th>
                                    <th>Aktif</th>
                                    <th></th>
                                </tr>
                            </thead>

                            <tbody>
                                @{ int sortnumber = 1;}
                                @foreach (var item in Model.ExpenseItems.OrderBy(x => x.SortBy).ToList())
                                {
                                    <tr>
                                        <td>@(sortnumber)</td>
                                        <td>@(item.ID)</td>
                                        <td>@(Model.OurCompanies.FirstOrDefault(x=> x.CompanyID == item.OurCompanyID)?.Code )</td>
                                        <td class="font-weight-bold tx-15"><a href="/Expense/NewItem/@(item.UID)">@(item.ExpenseItemName)</a></td>
                                        <td>@(item.IsLocation)</td>
                                        <td>@(item.IsOffice)</td>
                                        <td>@(item.IsGeneral)</td>
                                        <td>@(item.SortBy)</td>
                                        <td>@(item.IsActive == true ? "Aktif":"Pasif")</td>
                                        <td class="text-center"><a href="/Expense/ItemCheck/@(item.UID)" class="text-black-50"> <i data-feather="@(item.IsActive == true ? "check-circle":"x-circle")"></i></a></td>
                                    </tr>
                                    sortnumber++;
                                }
                            </tbody>

                        </table>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>


@section canvasmenu {

}

@section scripts {
    <script src="~/assets/js/ActionForceScript.js"></script>
    <script>
        $(function () {
            'use strict'
            $('.select2').select2({
                placeholder: 'Masraf Merkezi Seçiminiz',
                searchInputPlaceholder: 'Search options',
                allowClear: true
            });
            $('#DocumentDate').datepicker({
                dateFormat: "yy-mm-dd",
                dayNamesMin: ["Pz", "Pt", "Sa", "Ca", "Pe", "Cu", "Ct"],
                monthNames: ["Ocak", "Şubat", "Mart", "Nisan", "Mayıs", "Haziran", "Temmuz", "Ağustos", "Eylül", "Ekim", "Kasım", "Aralık"],
                firstDay: 1
            });

            $('#ExpensePeriod').datepicker({
                dateFormat: "yy-mm-dd",
                dayNamesMin: ["Pz", "Pt", "Sa", "Ca", "Pe", "Cu", "Ct"],
                monthNames: ["Ocak", "Şubat", "Mart", "Nisan", "Mayıs", "Haziran", "Temmuz", "Ağustos", "Eylül", "Ekim", "Kasım", "Aralık"],
                firstDay: 1
            });



            $('#DateBegin').datepicker({
                dateFormat: "yy-mm-dd",
                dayNamesMin: ["Pz", "Pt", "Sa", "Ca", "Pe", "Cu", "Ct"],
                monthNames: ["Ocak", "Şubat", "Mart", "Nisan", "Mayıs", "Haziran", "Temmuz", "Ağustos", "Eylül", "Ekim", "Kasım", "Aralık"],
                firstDay: 1
            });

            $('#DateEnd').datepicker({
                dateFormat: "yy-mm-dd",
                dayNamesMin: ["Pz", "Pt", "Sa", "Ca", "Pe", "Cu", "Ct"],
                monthNames: ["Ocak", "Şubat", "Mart", "Nisan", "Mayıs", "Haziran", "Temmuz", "Ağustos", "Eylül", "Ekim", "Kasım", "Aralık"],
                firstDay: 1
            });

            $('#ReturnWorkDate').datepicker({
                dateFormat: "yy-mm-dd",
                dayNamesMin: ["Pz", "Pt", "Sa", "Ca", "Pe", "Cu", "Ct"],
                monthNames: ["Ocak", "Şubat", "Mart", "Nisan", "Mayıs", "Haziran", "Temmuz", "Ağustos", "Eylül", "Ekim", "Kasım", "Aralık"],
                firstDay: 1
            });
        });
        $(function () {
            $('.shiftbegintime').mask('00:00');
            $('.hour').mask('00:00');
            $('.hourfull').mask('00:00:00');
            $('.shiftdate').mask('0000-00-00');
            $('.fulldate').mask('0000-00-00 00:00:00');
            $('.money').mask("#.##0,00", { reverse: true });
            $('.quantity').mask("##0", { reverse: true });
            $('.money4').mask("#.##0,0000", { reverse: true });
        });

        $(document).ready(function () {

            $("#ExpenseCenterID").change(function () {

                //var centerID = $("#ExpenseCenterID").val();
                var isprofit = $(this).find(':selected').data('group');

                if (isprofit == 'True') {

                    $("#ExpenseGroupID").find('option').remove().end();
                    $("#ExpenseGroupID").append("<option value=''>Masraf Grubu Seçiminiz</option>");
                    $("#ExpenseGroupID").append("<option value='1'>Lokasyon</option>");

                }
                else {

                    $("#ExpenseGroupID").find('option').remove().end();
                    $("#ExpenseGroupID").append("<option value=''>Masraf Grubu Seçiminiz</option>");
                    $("#ExpenseGroupID").append("<option value='2'>İşletme Maliyeti</option>");
                    $("#ExpenseGroupID").append("<option value='3'>Genel</option>");

                }
            });
        });

    </script>

    @if (Model.Result != null) //
    {
        <script type="text/javascript">
        $.toast({
            heading: 'Information',
            text: '@Model.Result.Message ',
            showHideTransition: 'slide',
            icon: 'info',
            hideAfter: 5000,
            position: 'bottom-right',
        });
        </script>
    }
}

