@model MallControlModel
@{
    ViewBag.Title = "AVM Ekle";
}

<div class="content-header">
    <div class="content-search">
        <h4>Yeni AVM Ekleme</h4>
    </div>
    <nav class="nav">
        @(DateTime.UtcNow.AddHours(Model.Authentication.ActionEmployee.OurCompany.TimeZone.Value).ToLongDateString())
    </nav>
</div>
<div class="content-body">
    <div class="pd-x-0 tx-13">
        <div class="media d-block d-lg-flex">
            <div class="media-body  mg-t-40 mg-lg-t-0">
                <div class="d-sm-flex align-items-center justify-content-between mg-b-20 mg-lg-b-25 mg-xl-b-30 row">
                    <div class=" col-md-4"></div>
                    <div class="col-md-11 tx-center">
                        <h4 class="mg-b-0 tx-spacing--1">AVM Bilgileri</h4>
                    </div>
                </div>
                <div id="mallStatus">
                    <div class="row no-gutters">
                        <div class="col-lg-12">
                            @using (Html.BeginForm("AddMall", "Mall", FormMethod.Post))
                            {
                                @Html.AntiForgeryToken()
                                <div class="row row-xs">
                                    <div class="col-lg-12">
                                        <div class="form-group row mg-b-5">
                                            <label for="ourCompany" class="col-sm-3 col-form-label">Firma</label>
                                            <div class="col-sm-6">
                                                <select class="form-control" id="ourCompany" name="OurCompany" required>
                                                    @if (Model?.OurCompanyList?.Count > 0)
                                                    {
                                                        <option value="">Seçiniz</option>

                                                        foreach (var item in Model.OurCompanyList)
                                                        {
                                                            <option value="@(item.CompanyID)" @(Model.Authentication.ActionEmployee.OurCompanyID == item.CompanyID ? "selected" : "")>@(item.CompanyName)</option>
                                                        }
                                                    }
                                                </select>
                                            </div>
                                            <div class="col-sm-3">
                                            </div>
                                        </div>
                                        <div class="form-group row mg-b-5">
                                            <label for="mallName" class="col-sm-3 col-form-label">AVM İsmi</label>
                                            <div class="col-sm-6">
                                                <input id="mallName" name="MallName" type="text" class="form-control" autocomplete="off" placeholder="AVM İsmi" value="@(Model?.CheckMall?.FullName)">
                                            </div>
                                            <div class="col-sm-3">
                                            </div>
                                        </div>
                                        <div class="form-group row mg-b-5">
                                            <label for="locationTypeID" class="col-sm-3 col-form-label">AVM Segmenti</label>
                                            <div class="col-sm-6">
                                                <select class="form-control" id="locationTypeID" name="LocationTypeID" required="">
                                                    @if (Model?.MallSegmentList?.Count > 0)
                                                    {
                                                        <option value="">Seçiniz</option>

                                                        foreach (var item in Model.MallSegmentList)
                                                        {
                                                            <option value="@(item.ID)" @(Model?.CheckMall?.MallSegmentID == item.ID ? "selected" : "")>@(item.SegmentName)</option>
                                                        }
                                                    }
                                                </select>
                                            </div>
                                            <div class="col-sm-3">
                                            </div>
                                        </div>
                                        <div class="form-group row mg-b-5">
                                            <label for="structuralCondition" class="col-sm-3 col-form-label">AVM Fiziki Durumu</label>
                                            <div class="col-sm-6">
                                                <input id="mallStructuralCondition" name="MallStructuralCondition" type="text" class="form-control" autocomplete="off" placeholder="AVM Fiziki Durumu" value="@(Model?.CheckMall?.StructuralCondition)">
                                            </div>
                                            <div class="col-sm-3">
                                            </div>
                                        </div>
                                        <div class="form-group row mg-b-5">
                                            <label for="mallAdress" class="col-sm-3 col-form-label">AVM Adresi</label>
                                            <div class="col-sm-6">
                                                <input id="mallAddress" name="MallAddress" type="text" class="form-control" autocomplete="off" placeholder="AVM Adresi" value="@(Model?.CheckMall?.Address)">
                                            </div>
                                            <div class="col-sm-3">
                                            </div>
                                        </div>
                                        <div class="form-group row mg-b-5">
                                            <label for="mallCountry" class="col-sm-3 col-form-label">Ülke</label>
                                            <div class="col-sm-6">
                                                <input id="mallCountry" name="MallCountry" type="text" class="form-control" autocomplete="off" value="@(Model?.RelatedCountry?.CountryName)" readonly>
                                            </div>
                                            <div class="col-sm-3">
                                            </div>
                                        </div>
                                        <div class="form-group row mg-b-5">
                                            <label for="mallState" class="col-sm-3 col-form-label">Eyalet</label>
                                            <div class="col-sm-6">
                                                <select class="form-control" id="mallStateID" name="MallStateID" required="">
                                                    @if (Model?.StateList?.Count > 0)
                                                    {
                                                        <option value="">Seçiniz</option>

                                                        foreach (var item in Model.StateList)
                                                        {
                                                            <option value="@(item.ID)" @(Model?.CheckMall?.State == item.ID ? "selected" : "")>@(item.StateName)</option>
                                                        }
                                                    }
                                                </select>
                                            </div>
                                            <div class="col-sm-3">
                                            </div>
                                        </div>
                                        <div class="form-group row mg-b-5">
                                            <label for="mallCity" class="col-sm-3 col-form-label">Şehir</label>
                                            <div class="col-sm-6">
                                                <select class="form-control" id="mallCityID" name="MallCityID" required="">
                                                    @if (Model?.CityList?.Count > 0)
                                                    {
                                                        <option value="">Seçiniz</option>

                                                        foreach (var item in Model.CityList)
                                                        {
                                                            <option value="@(item.ID)" @(Model?.CheckMall?.City == item.ID ? "selected" : "")>@(item.CityName)</option>
                                                        }
                                                    }
                                                </select>
                                            </div>
                                            <div class="col-sm-3">
                                            </div>
                                        </div>
                                        <div class="form-group row mg-b-5">
                                            <label for="mallCounty" class="col-sm-3 col-form-label">İlçe</label>
                                            <div class="col-sm-6">
                                                <select class="form-control" id="mallCountyID" name="MallCountyID" required="">
                                                    @if (Model?.CountyList?.Count > 0)
                                                    {
                                                        <option value="">İlçe Seçiniz</option>

                                                        foreach (var item in Model.CountyList)
                                                        {
                                                            <option value="@(item.ID)" @(Model?.CheckMall?.County == item.ID ? "selected" : "")>@(item.CountyName)</option>
                                                        }
                                                    }
                                                </select>
                                            </div>
                                            <div class="col-sm-3">
                                            </div>
                                        </div>
                                        <div class="form-group row mg-b-5">
                                            <label for="mallPostCode" class="col-sm-3 col-form-label">Posta Kodu</label>
                                            <div class="col-sm-6">
                                                <input id="mallPostCode" name="MallPostCode" type="text" class="form-control" autocomplete="off" placeholder="Posta Kodu" value="@(Model?.CheckMall?.PostCode)">
                                            </div>
                                            <div class="col-sm-3">
                                            </div>
                                        </div>
                                        <div class="form-group row mg-b-5">
                                            <label for="phoneCountryCode" class="col-sm-3 col-form-label">Ülke Telefon Kodu</label>
                                            <div class="col-sm-6">
                                                <input id="countryPhoneCode" name="CountryPhoneCode" type="text" class="form-control" autocomplete="off" placeholder="Ülke Telefon Kodu" value="@(Model?.CheckMall?.PhoneCountryCode)">
                                            </div>
                                            <div class="col-sm-3">
                                            </div>
                                        </div>
                                        <div class="form-group row mg-b-5">
                                            <label for="phoneNumber" class="col-sm-3 col-form-label">Telefon Numarası</label>
                                            <div class="col-sm-6">
                                                <input id="phoneNumber" name="PhoneNumber" type="text" class="form-control" autocomplete="off" placeholder="Telefon Numarası" value="@(Model?.CheckMall?.PhoneNumber)">
                                            </div>
                                            <div class="col-sm-3">
                                            </div>
                                        </div>
                                        <div class="form-group row mg-b-5">
                                            <label for="latitude" class="col-sm-3 col-form-label">Enlem</label>
                                            <div class="col-sm-6">
                                                <input id="latitude" name="latitude" type="text" class="form-control" autocomplete="off" placeholder="Enlem" value="@(Model?.CheckMall?.Latitude)">
                                            </div>
                                            <div class="col-sm-3">
                                            </div>
                                        </div>
                                        <div class="form-group row mg-b-5">
                                            <label for="Longitude" class="col-sm-3 col-form-label">Boylam</label>
                                            <div class="col-sm-6">
                                                <input id="Longitude" name="Longitude" type="text" class="form-control" autocomplete="off" placeholder="Boylam" value="@(Model?.CheckMall?.Longitude)">
                                            </div>
                                            <div class="col-sm-3">
                                            </div>
                                        </div>
                                        <div class="form-group row mg-b-5">
                                            <label for="mallMapUrl" class="col-sm-3 col-form-label">AVM Map URL</label>
                                            <div class="col-sm-6">
                                                <input id="mallMapUrl" name="MallMapUrl" type="text" class="form-control" autocomplete="off" placeholder="AVM Map URL" value="@(Model?.CheckMall?.Map)">
                                            </div>
                                            <div class="col-sm-3">
                                            </div>
                                        </div>
                                        <div class="form-group row mg-b-5">
                                            <label for="mallInvestorCompany" class="col-sm-3 col-form-label">Yatırımcı Şirket Ünvanı</label>
                                            <div class="col-sm-6">
                                                <select class="form-control" id="mallInvestorCompanyID" name="MallInvestorCompanyID" required="">
                                                    @if (Model?.InvestorCompanyList?.Count > 0)
                                                    {
                                                        <option value="">Seçiniz</option>

                                                        foreach (var item in Model.InvestorCompanyList)
                                                        {
                                                            <option value="@(item.ID)" @(Model?.CheckMall?.InvestorCompanyID == item.ID ? "selected" : "")>@(item.FullName)</option>
                                                        }
                                                    }
                                                </select>
                                            </div>
                                            <div class="col-sm-3">
                                            </div>
                                        </div>
                                        <div class="form-group row mg-b-5">
                                            <label for="mallLeasingCompany" class="col-sm-3 col-form-label">Kiralama Firması</label>
                                            <div class="col-sm-6">
                                                <select class="form-control" id="mallLeasingCompanyID" name="MallLeasingCompanyID" required="">
                                                    @if (Model?.LeasingCompanyList?.Count > 0)
                                                    {
                                                        <option value="">Seçiniz</option>

                                                        foreach (var item in Model.LeasingCompanyList)
                                                        {
                                                            <option value="@(item.ID)" @(Model?.CheckMall?.LeasingCompanyID == item.ID ? "selected" : "")>@(item.FullName)</option>
                                                        }
                                                    }
                                                </select>
                                            </div>
                                            <div class="col-sm-3">
                                            </div>
                                        </div>
                                        <div class="form-group row mg-b-5">
                                            <label for="timezone" class="col-sm-3 col-form-label">Time Zone</label>
                                            <div class="col-sm-6">
                                                <select class="form-control" id="timezone" name="Timezone" required="">
                                                    <option value="">Seçiniz</option>

                                                    @for (int i = 3; i >= -13; i--)
                                                    {
                                                        <option value="@i" @(Model?.CheckMall?.Timezone == i ? "selected" : "")>@( i > 0 ? "+" + i : i.ToString())</option>
                                                    }
                                                </select>
                                            </div>
                                            <div class="col-sm-3">
                                            </div>
                                        </div>
                                        <div class="form-group row mg-b-5">
                                            <label for="isActive" class="col-sm-3 col-form-label">Aktif mi?</label>
                                            <div class="col-sm-6">
                                                <div class="custom-control custom-checkbox">
                                                    <input type="checkbox" class="custom-control-input" id="isActive" name="IsActive" value="1" @(Model?.CheckMall?.IsActive == true ? "checked" : "")>
                                                    <label class="custom-control-label" for="isActive">Aktif</label>
                                                </div>
                                            </div>
                                            <div class="col-sm-3">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            }
                        </div>
                    </div>
                </div>
            </div>
            <div class="media-body  mg-t-40 mg-lg-t-0">
                <div class="d-sm-flex align-items-center justify-content-between mg-b-20 mg-lg-b-25 mg-xl-b-30 row">
                    <div class=" col-md-4"></div>
                    <div class="col-md-4 tx-center">
                        <h4 class="mg-b-0 tx-spacing--1">İletişim Bilgileri</h4>
                    </div>
                    <div class="d-none d-md-block col-md-4 tx-right">
                        <a href="/Mall/Index" class="btn btn-primary btn-uppercase"><i data-feather="map-pin"></i> &nbsp; AVM Listesi</a>
                    </div>
                </div>
                <div id="mallStatus">
                    <div class="row no-gutters">
                        <div class="col-lg-12">
                            @using (Html.BeginForm("AddMall", "Mall", FormMethod.Post))
                            {
                                @Html.AntiForgeryToken()
                                <div class="row row-xs">
                                    <div class="col-lg-12">
                                        <div class="form-group row mg-b-5">
                                            <label for="mallContactTitle" class="col-sm-3 col-form-label">İletişim Kurulacak Kişinin Ünvanı</label>
                                            <div class="col-sm-6">
                                                <input id="mallMasterContactTitle" name="MallMasterContactTitle" type="text" class="form-control" autocomplete="off" placeholder="İletişim Kurulacak Kişinin Ünvanı" value="@(Model?.CheckMallContact?.Title)">
                                            </div>
                                            <div class="col-sm-3">
                                            </div>
                                        </div>
                                        <div class="form-group row mg-b-5">
                                            <label for="mallContactFullName" class="col-sm-3 col-form-label">İletişim Kurulacak Kişinin Adı Soyadı</label>
                                            <div class="col-sm-6">
                                                <input id="mallContactFullName" name="MallContactFullName" type="text" class="form-control" autocomplete="off" placeholder="İletişim Kurulacak Kişinin Adı Soyadı" value="@(Model?.CheckMallContact?.FullName)">
                                            </div>
                                            <div class="col-sm-3">
                                            </div>
                                        </div>
                                        <div class="form-group row mg-b-5">
                                            <label for="phoneContactCode" class="col-sm-3 col-form-label">Ülke Telefon Kodu</label>
                                            <div class="col-sm-6">
                                                <input id="phoneContactCode" name="PhoneContactCode" type="text" class="form-control" autocomplete="off" placeholder="Telefon Kodu" value="@(Model?.CheckMallContact?.PhoneCode)">
                                            </div>
                                            <div class="col-sm-3">
                                            </div>
                                        </div>
                                        <div class="form-group row mg-b-5">
                                            <label for="contactPhoneNumber" class="col-sm-3 col-form-label">Telefon Numarası</label>
                                            <div class="col-sm-6">
                                                <input id="contactPhoneNumber" name="ContactPhoneNumber" type="text" class="form-control" autocomplete="off" placeholder="Telefon Numarası" value="@(Model?.CheckMallContact?.PhoneNumber)">
                                            </div>
                                            <div class="col-sm-3">
                                            </div>
                                        </div>
                                        <div class="form-group row mg-b-5">
                                            <label for="contactEmail" class="col-sm-3 col-form-label">Email</label>
                                            <div class="col-sm-6">
                                                <input id="contactEmail" name="ContactEmail" type="email" class="form-control" autocomplete="off" placeholder="Email" value="@(Model?.CheckMallContact?.Email)">
                                            </div>
                                            <div class="col-sm-3">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            }
                        </div>
                            <div class=" col-md-4"></div>
                            <div class="col-md-4 tx-center mg-y-30-f">
                                <h4 class="mg-b-0 tx-spacing--1">Sözleşme Bilgileri</h4>
                            </div>
                        <div class="col-lg-12">
                            @using (Html.BeginForm("AddMall", "Mall", FormMethod.Post))
                            {
                                @Html.AntiForgeryToken()
                                <div class="row row-xs">
                                    <div class="col-lg-12">
                                        <div class="form-group row mg-b-5">
                                            <label for="ourCompany" class="col-sm-3 col-form-label">Firma</label>
                                            <div class="col-sm-6">
                                                <select class="form-control" id="ourCompany" name="OurCompany" required>
                                                    @if (Model?.OurCompanyList?.Count > 0)
                                                    {
                                                        <option value="">Seçiniz</option>

                                                        foreach (var item in Model.OurCompanyList)
                                                        {
                                                            <option value="@(item.CompanyID)" @(Model.Authentication.ActionEmployee.OurCompanyID == item.CompanyID ? "selected" : "")>@(item.CompanyName)</option>
                                                        }
                                                    }
                                                </select>
                                            </div>
                                            <div class="col-sm-3">
                                            </div>
                                        </div>
                                        <div class="form-group row mg-b-5">
                                            <label for="mallName" class="col-sm-3 col-form-label">AVM İsmi</label>
                                            <div class="col-sm-6">
                                                <input id="mallName" name="MallName" type="text" class="form-control" autocomplete="off" placeholder="AVM İsmi" value="@(Model?.CheckMall?.FullName)">
                                            </div>
                                            <div class="col-sm-3">
                                            </div>
                                        </div>
                                        <div class="form-group row mg-b-5">
                                            <label for="locationTypeID" class="col-sm-3 col-form-label">AVM Segmenti</label>
                                            <div class="col-sm-6">
                                                <select class="form-control" id="locationTypeID" name="LocationTypeID" required="">
                                                    @if (Model?.MallSegmentList?.Count > 0)
                                                    {
                                                        <option value="">Seçiniz</option>

                                                        foreach (var item in Model.MallSegmentList)
                                                        {
                                                            <option value="@(item.ID)" @(Model?.CheckMall?.MallSegmentID == item.ID ? "selected" : "")>@(item.SegmentName)</option>
                                                        }
                                                    }
                                                </select>
                                            </div>
                                            <div class="col-sm-3">
                                            </div>
                                        </div>
                                        <div class="form-group row mg-b-5">
                                            <label for="structuralCondition" class="col-sm-3 col-form-label">AVM Fiziki Durumu</label>
                                            <div class="col-sm-6">
                                                <input id="mallStructuralCondition" name="MallStructuralCondition" type="text" class="form-control" autocomplete="off" placeholder="AVM Fiziki Durumu" value="@(Model?.CheckMall?.StructuralCondition)">
                                            </div>
                                            <div class="col-sm-3">
                                            </div>
                                        </div>
                                        <div class="form-group row mg-b-5">
                                            <label for="mallAdress" class="col-sm-3 col-form-label">AVM Adresi</label>
                                            <div class="col-sm-6">
                                                <input id="mallAddress" name="MallAddress" type="text" class="form-control" autocomplete="off" placeholder="AVM Adresi" value="@(Model?.CheckMall?.Address)">
                                            </div>
                                            <div class="col-sm-3">
                                            </div>
                                        </div>
                                        <div class="form-group row mg-b-5">
                                            <label for="mallCountry" class="col-sm-3 col-form-label">Ülke</label>
                                            <div class="col-sm-6">
                                                <input id="mallCountry" name="MallCountry" type="text" class="form-control" autocomplete="off" value="@(Model?.RelatedCountry?.CountryName)" readonly>
                                            </div>
                                            <div class="col-sm-3">
                                            </div>
                                        </div>
                                        <div class="form-group row mg-b-5">
                                            <label for="mallState" class="col-sm-3 col-form-label">Eyalet</label>
                                            <div class="col-sm-6">
                                                <select class="form-control" id="mallStateID" name="MallStateID" required="">
                                                    @if (Model?.StateList?.Count > 0)
                                                    {
                                                        <option value="">Seçiniz</option>

                                                        foreach (var item in Model.StateList)
                                                        {
                                                            <option value="@(item.ID)" @(Model?.CheckMall?.State == item.ID ? "selected" : "")>@(item.StateName)</option>
                                                        }
                                                    }
                                                </select>
                                            </div>
                                            <div class="col-sm-3">
                                            </div>
                                        </div>
                                        <div class="form-group row mg-b-5">
                                            <label for="mallCity" class="col-sm-3 col-form-label">Şehir</label>
                                            <div class="col-sm-6">
                                                <select class="form-control" id="mallCityID" name="MallCityID" required="">
                                                    @if (Model?.CityList?.Count > 0)
                                                    {
                                                        <option value="">Seçiniz</option>

                                                        foreach (var item in Model.CityList)
                                                        {
                                                            <option value="@(item.ID)" @(Model?.CheckMall?.City == item.ID ? "selected" : "")>@(item.CityName)</option>
                                                        }
                                                    }
                                                </select>
                                            </div>
                                            <div class="col-sm-3">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            }
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
@section scripts {

    <script type="text/javascript">

        $(document).ready(function () {

            $("#mallCityID").change(function () {

                var cityID = $("#mallCityID").val();

                $.ajax
                    ({
                        url: '/Mall/GetCountyList',
                        type: 'POST',
                        datatype: 'application/json',
                        contentType: 'application/json',
                        data: JSON.stringify({
                            id: cityID,
                        }),
                        success: function (data) {

                            $("#mallCountyID").empty();
                            $("#mallCountyID").append($('<option></option>', { "value": "", "text": "İlçe Seçiminiz" }));
                            $.each(data, function (index, label) {
                                $("#mallCountyID").append($('<option></option>', { "value": label.Value, "text": label.Text }));
                            });
                        },
                        error: function () {
                        },
                    });

            });
        });
    </script>

    <script type="text/javascript">

        $(document).ready(function () {

            $("#mallStateID").change(function () {

                var stateID = $("#mallStateID").val();
                console.log(stateID);
                $.ajax
                    ({
                        url: '/Mall/GetCityList',
                        type: 'POST',
                        datatype: 'application/json',
                        contentType: 'application/json',
                        data: JSON.stringify({
                            id: stateID,
                        }),
                        success: function (data) {

                            $("#mallCityID").empty();
                            $("#mallCityID").append($('<option></option>', { "value": "", "text": "İl Seçiminiz" }));
                            $.each(data, function (index, city) {
                                $("#mallCityID").append($('<option></option>', { "value": city.Value, "text": city.Text }));
                            });
                        },
                        error: function () {
                        },
                    });

            });
        });
    </script>
    @if (Model.Result != null) //
    {
        <script type="text/javascript">
        $.toast({
            heading: 'Information',
            text: '@Model.Result.Message ',
            showHideTransition: 'slide',
            icon: 'info',
            hideAfter: 5000,
            position: 'bottom-right',
        });
        </script>
    }
}